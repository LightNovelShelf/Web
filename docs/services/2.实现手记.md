# 手记

1. 对 signalr 整体做一个抽象，对外不暴露构造器参数等细节，只保留能力与状态
   1. 保留 cache/inspector 设定
   1. 对外提供 invoke / subscribe(on+off) / reboot 的能力组合
      1. 其实也可以暴露底层的hub，这个到时候权衡一下成本收益
2. 封装出一个类 axios 的请求界面，支持拦截器与参数
   1. 类状态机的抽象思路或许值得考虑：中间件可以重启请求
3. 在`2.`的外层wrap流控逻辑，不分开初始化

## 并发限制

参考原[issue](https://github.com/LightNovelShelf/Web/issues/7)的沟通记录，项目中`RateLimitQueue`的实现目的仅是并发控制。
对比起这个目的，队列这个概念更倾向于对消费行为的控制，业务把控制权委托给队列控制器，借此实现消费行为的“塑形”，如满足什么特征/频率，甚至控制流（if/else/then/throw）的更改。
如果仅是针对并发控制，采用最简单的counter即可满足（无需考虑时间窗口），这在代码体积/性能上都有更好表现；无需追求大而全的队列维护与行为塑形。
